name: Build & Release

on:
  push:
    tags:
      - '*'

jobs:
  build-windows:
    uses: ./.github/workflows/build-windows.yml
    with:
      tag: ${{ github.ref_name }}

  build-linux-x64:
    uses: ./.github/workflows/build-linux-x64.yml
    with:
      tag: ${{ github.ref_name }}

  build-linux-aarch64:
    uses: ./.github/workflows/build-linux-aarch64.yml
    with:
      tag: ${{ github.ref_name }}

  build-macos:
    uses: ./.github/workflows/build-macos.yml
    with:
      tag: ${{ github.ref_name }}

  create-release:
    needs:
      - build-windows
      - build-linux-x64
      - build-linux-aarch64
      - build-macos
    uses: ./.github/workflows/create-release.yml
    with:
      tag: ${{ github.ref_name }}
